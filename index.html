<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description"
        content="FLIPNET: Unlocking the Potential of Diffusion Priors in Blind Face Restoration">
  <meta name="keywords" content="Diffusion">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>FLIPNET</title>
  <style>
        .iccv-badge {
        margin-top: 20px;
        display: inline-block;
        background-color: #FA8072;
        color: white;
        padding: 6px 14px;
        font-size: 0.95rem;
        font-weight: 600;
        border-radius: 6px;
        margin-bottom: 20px;
      }
  </style>


  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-PYVRSFMDRL"></script>
  <script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
      dataLayer.push(arguments);
    }

    gtag('js', new Date());

    gtag('config', 'G-PYVRSFMDRL');
</script>

  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro">

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">
  <link rel="icon" href="./static/images/favicon.svg">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>

  <!-- Vendor Stylesheets -->
  <!--=================js==========================-->
  <link rel="stylesheet" href="./static/css/tab_gallery.css">
  <link rel="stylesheet" href="./static/css/juxtapose.css">
  <link rel="stylesheet" href="./static/css/image_card_fader.css">
  <link rel="stylesheet" href="./static/css/image_card_slider.css">
</head>
<body>

<nav class="navbar" role="navigation" aria-label="main navigation">
  <div class="navbar-brand">
    <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
    </a>
  </div>
  <div class="navbar-menu">
    <div class="navbar-start" style="flex-grow: 1; justify-content: center;">
      <a class="navbar-item" href="https://yoqim.github.io">
      <span class="icon">
          <i class="fas fa-home"></i>
      </span>
      </a>

      <div class="navbar-item has-dropdown is-hoverable">
        <a class="navbar-link">
          More Research
        </a>
        <div class="navbar-dropdown">
          <a class="navbar-item" href="https://yoqim.github.io/waveface_page/">
            WaveFace
          </a>
          <a class="navbar-item" href="https://github.com/yoqim/PR-HFR">
            NIR-VIS Face Recognition
          </a>
          <a class="navbar-item" href="https://insightface.ai">
            InsightFace
          </a>
        </div>
      </div>
    </div>

  </div>
</nav>


<section class="hero">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column has-text-centered">
          <h1 class="title is-1 publication-title"><span style="color:#fb5a42">FLIPNET</span>: Unlocking the Potential of Diffusion Priors in Blind Face Restoration</h1>
          <div class="is-size-5 publication-authors">
            <span class="author-block">
              <a href="https://yoqim.github.io">Yunqi Miao</a><sup>1</sup>,</span>
            <span class="author-block">
              <a href="https://github.com/WinKawaks">Zhiyu Qu</a><sup>4</sup>,</span>
            <span class="author-block">
              <a href="https://mingqigao.com">Mingqi Gao</a><sup>3</sup>,</span>
            <span class="author-block">
              <a href="https://www.geoch.top">Changrui Chen</a><sup>1</sup>,</span>
            <span class="author-block">
              <a href="https://scholar.google.com/citations?hl=en&user=9a1PjCIAAAAJ&view_op=list_works&sortby=pubdate">Jifei Song</a><sup>4</sup>,</span>
            <span class="author-block">
              <a href="https://jungonghan.github.io">Jungong Han</a><sup>3</sup>,
            <span class="author-block">
              <a href="https://jiankangdeng.github.io">Jiankang Deng</a><sup>2</sup>,</span>

            </span>
          </div>

          <div class="is-size-5 publication-authors">
            <span class="author-block"><sup>1</sup>University of Warwick,</span>
            <span class="author-block"><sup>2</sup>Imperial College London</span>
            <span class="author-block"><sup>3</sup>University of Sheffield</span>
            <span class="author-block"><sup>4</sup>University of Surrey</span>
          </div>

          <div class="iccv-badge">ðŸ“£ Accepted at ICCV 2025</div>
          <div class="column has-text-centered">
            <div class="publication-links">
              <!-- PDF Link. -->
              <span class="link-block">
                <a href="https://arxiv.org/html/2508.08556v1"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fas fa-file-pdf"></i>
                  </span>
                  <span>Paper</span>
                </a>
              </span>
              <span class="link-block">
                <a href="https://arxiv.org/html/2508.08556v1"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="ai ai-arxiv"></i>
                  </span>
                  <span>arXiv</span>
                </a>
              </span>
              <!-- Code Link. -->
              <!-- <span class="link-block">
                <a href=""
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-google-drive"></i>
                  </span>
                  <span>Dataset</span>
                </a>
              </span> -->
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<!--=================Teasers==========================-->
<section class="hero is-small">
  <div class="hero-body">
    <div class="container is-max-desktop has-text-centered">
      <!-- The expanding image container -->
      <div class="tab_container">
        <!-- Close the image -->
        <!-- <span onclick="this.parentElement.style.display='none'" class="closebtn">&times;</span> -->

        <!-- Expanded image -->
        <div id="juxtapose-embed" data-startingposition="30%" data-animate="true" class="juxtapose" style="height:700px; width: 700px;">
        <!-- <div class="jx-slider">
            <div class="jx-handle " style="left: 50%;">
              <div class="jx-arrow jx-left"></div>
              <div class="jx-control">
                <div class="jx-controller" tabindex="0" role="slider" aria-valuenow="50" aria-valuemin="0"
                  aria-valuemax="100"></div>
              </div>
              <div class="jx-arrow jx-right"></div>
            </div>
            <div class="jx-image jx-left " style="width: 50%;"><img src="./src/UDC_1.png" alt="">
              <div class="jx-label" tabindex="0">UDC images</div>
            </div>
            <div class="jx-image jx-right " style="width: 50%;"><img src="./src/AF_1.png" alt="">
              <div class="jx-label" tabindex="0">AlignFormer results</div>
            </div><a href="https://juxtapose.knightlab.com" target="_blank" rel="noopener" class="jx-knightlab">
              <div class="knightlab-logo"></div><span class="juxtapose-name">JuxtaposeJS</span>
            </a>
          </div> -->
        </div>

        <div>
          <div id="juxtapose-hidden"></div>
        </div>

        <!-- Image text -->
        <div id="imgtext"></div>
      </div>

      <!-- The grid: four columns -->
      <div class="tab_row">
        <div class="tab_column">
          <img src="static/images/Solvay_conference_1_LQ.png" onclick="tab_gallery_click('Solvay_conference_1');">
        </div>
        
        <div class="tab_column">
          <img src="static/images/Solvay_conference_2_LQ.png" onclick="tab_gallery_click('Solvay_conference_2');">
        </div>

        <div class="tab_column">
          <img src="static/images/0342_LQ.png" onclick="tab_gallery_click('0342');">
        </div>

        <div class="tab_column">
          <img src="static/images/0478_LQ.png" onclick="tab_gallery_click('0478');">
        </div>

        <div class="tab_column">
          <img src="static/images/0500_LQ.png" onclick="tab_gallery_click('0500');">
        </div>

      </div>
    </div>
  </div>
</section>


<section class="section">
  <div class="container is-max-desktop">
    <!-- Abstract. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified">
          <p>
          Although diffusion prior is rising as a powerful solution for blind face restoration (BFR), the inherent gap between the vanilla diffusion model and BFR settings hinders its seamless adaptation. The gap mainly stems from the discrepancy between 1) high-quality (HQ) and low-quality (LQ) images and 2) synthesized and real-world images. The vanilla diffusion model is trained on images with no or less degradations, whereas BFR handles moderately to severely degraded images. Additionally, LQ images used for training are synthesized by a naive degradation model with limited degradation patterns, which fails to simulate complex and unknown degradations in real-world scenarios. In this work, we use a unified network FLIPNET that switches between two modes to resolve specific gaps. In restoration mode, the model gradually integrates BFR-oriented features and face embeddings from LQ images to achieve authentic and faithful face restoration. In degradation mode, the model synthesizes real-world like degraded images based on the knowledge learned from real-world degradation datasets.
          Extensive evaluations on benchmark datasets show that our model 1) outperforms previous diffusion prior based BFR methods in terms of authenticity and fidelity, and 2) outperforms the naive degradation model in modeling the real-world degradations.
          </p>
        </div>
      </div>
    </div>
    <!--/ Abstract. -->
    <!-- Paper. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Method</h2>
            <div class="center-image">
              <figure>
                <img src="./static/images/pipeline.png" class="interpolation-image"
                  alt="Interpolate start reference image." />
                <figcaption style="text-align: justify;">
                  <strong>Overview of our model structure.</strong>
                  FLIPNET takes noisy high-quality (HQ) and low-quality (LQ) image pairs as input. It can switch between restoration mode and degradation mode. Taking restoration mode as an example, HQ images are used as input while LQ images are condition, where a BoostHub is placed in parallel to each self-attention layer to selectively integrate the BFR-oriented LQ features for denoising. Additionally, LoRA weights are plugged to all self-attention and cross-attention layers to adapt the base model to face domain. By simply flipping the image-condition order, it switches to degradation mode to synthesize degraded data with real-world degradations.
                </figcaption>
              </figure>
            </div>
      </div>
    </div>
    <!--/ Paper video. -->
  </div>
  </section>

<section class="section">
  <div class="container is-max-desktop">
    <!-- Results -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Results</h2>
        <div class="content has-text-justified">
          <p>
          We provide the synthetic <a href="https://drive.google.com/file/d/1lrXAJrZ-zMn-9wuMIc12p19qrNO7SJdG/view?usp=drive_link">CelebA-Test</a> used in our paper and <a href="https://drive.google.com/file/d/1m6vAa08rbqsNAjrNJsiUOQCiIAVkSOQo/view?usp=drive_link">our restoration</a> results. Please download to check more results.
          </p>
            <div class="center-image">
              <figure>
                <img src="./static/images/SOTA_syn.png" class="interpolation-image"
                  alt="Interpolate start reference image." />
                <figcaption>
                  Comparison with state-of-the-art methods on <strong>CelebA-Test</strong>.
                </figcaption>
              </figure>
            </div>
            <p>

            </p>
            <div class="center-image">
              <figure>
                <img src="./static/images/SOTA_real.png" class="interpolation-image"
                  alt="Interpolate start reference image." />
                <figcaption>
                  Comparison with state-of-the-art methods on <strong>Real-world datasets</strong>.
                </figcaption>
              </figure>
            </div>

      </div>
    </div>
    <!--/ Results -->
  </div>
</section>


<section class="section" id="BibTeX">
  <div class="container is-max-desktop content">
    <h2 class="title">BibTeX</h2>
    <pre><code>@article{miao2025flipnet,
          author    = {Miao, Yunqi and Qu, Zhiyu and Gao, mingqi and Chen, Changrui and Song, jifei and Han, Jungong and Deng, Jiankang},
          title     = {Unlocking the Potential of Diffusion Priors in Blind Face Restoration},
          journal   = {ICCV},
          year      = {2025}
        }
    </code></pre>
  </div>
</section>

<footer class="footer">
  <div class="container">
    <div class="content has-text-centered">
      <!-- <a class="icon-link"
         href="https://arxiv.org/pdf/2403.12760.pdf">
        <i class="fas fa-file-pdf"></i>
      </a> -->
      <!-- <a class="icon-link" href="https://drive.google.com/drive/folders/1T2Wor0KXbdZkod8YvoSKOkQCZHXXAiPq?usp=sharing" class="external-link" disabled>
        <i class="fab fa-google-drive"></i>
      </a> -->
    </div>
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">
          <p>
            This page borrows the <a href="https://github.com/nerfies/nerfies.github.io">source code</a>. This website is licensed under a <a rel="license"
                                                href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
            Commons Attribution-ShareAlike 4.0 International License</a>.
          </p>
        </div>
      </div>
    </div>
  </div>
</footer>

<!-- Image Slider Javascripts -->
<!--=================Functions==========================-->
<script src="./static/js/juxtapose.js"></script>

<script>
  var slider;
  let origImages = [
    { "src": "./static/images/Solvay_conference_1_LQ.png", "label": "Input", },
    { "src": "./static/images/Solvay_conference_1_HQ.png", "label": "Ours", }
  ];
  let origOptions = {
    "makeResponsive": true,
    "showLabels": true,
    "mode": "horizontal",
    "showCredits": true,
    "animate": true,
    "startingPosition": "50"
  };

  const juxtaposeSelector = "#juxtapose-embed";
  const transientSelector = "#juxtapose-hidden";


  function tab_gallery_click(name) {
    // Get the expanded image
    let inputImage = {
      label: "Input",
    };
    let outputImage = {
      label: "Ours",
    };

    inputImage.src = "./static/images/".concat(name, "_LQ", ".png")
    outputImage.src = "./static/images/".concat(name, "_HQ", ".png")

    let images = [inputImage, outputImage];
    let options = slider.options;
    options.callback = function (obj) {
      var newNode = document.getElementById(obj.selector.substring(1));
      var oldNode = document.getElementById(juxtaposeSelector.substring(1));
      console.log(obj.selector.substring(1));
      console.log(newNode.children[0]);
      oldNode.replaceChild(newNode.children[0], oldNode.children[0]);
      //newNode.removeChild(newNode.children[0]);

    };

    slider = new juxtapose.JXSlider(transientSelector, images, options);
  };

  (function () {
    slider = new juxtapose.JXSlider(
      juxtaposeSelector, origImages, origOptions);
    //document.getElementById("left-button").onclick = replaceLeft;
    //document.getElementById("right-button").onclick = replaceRight;
  })();
  // Get the image text
  var imgText = document.getElementById("imgtext");
  // Use the same src in the expanded image as the image being clicked on from the grid
  // expandImg.src = imgs.src;
  // Use the value of the alt attribute of the clickable image as text inside the expanded image
  imgText.innerHTML = name;
  // Show the container element (hidden with CSS)
  // expandImg.parentElement.style.display = "block";

  $(".flip-card").click(function () {
    console.log("fading in")
    div_back = $(this).children().children()[1]
    div_front = $(this).children().children()[0]
    // console.log($(this).children("div.flip-card-back"))
    console.log(div_back)
    $(div_front).addClass("out");
    $(div_front).removeClass("in");

    $(div_back).addClass("in");
    $(div_back).removeClass("out");

  });

  $(".flip-card").mouseleave(function () {
    console.log("fading in")
    div_back = $(this).children().children()[1]
    div_front = $(this).children().children()[0]
    // console.log($(this).children("div.flip-card-back"))
    console.log(div_back)
    $(div_front).addClass("in");
    $(div_front).removeClass("out");

    $(div_back).addClass("out");
    $(div_back).removeClass("in");

  });
</script>


</body>
</html>
